

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting started &mdash; maelstrom 0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Choosing the correct frequencies" href="Estimating frequencies.html" />
    <link rel="prev" title="Citing" href="../user/citation.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> maelstrom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/citation.html">Citing</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Estimating frequencies.html">Choosing the correct frequencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Custom priors.html">Custom priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Recovering weak signals.html">Recovering weak signals</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies from paper</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/9651065.html">KIC 9651065</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/6780873.html">KIC 6780873</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/10080943.html">KIC 10080943</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/maelstrom.html">Maelstrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/orbit.html">Orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/periodogram.html">Periodogram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/estimator.html">Estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/eddy.html">Eddy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">maelstrom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Getting started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Getting started.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Getting-started">
<h1>Getting started<a class="headerlink" href="#Getting-started" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">corner</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">exoplanet</span> <span class="k">as</span> <span class="nn">xo</span>
<span class="kn">import</span> <span class="nn">pymc3</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">lightkurve</span> <span class="k">as</span> <span class="nn">lk</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">config</span> IPython.matplotlib.backend = &quot;retina&quot;
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;savefig.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
<p>In this notebook, we’re going to inspect and fit the time delays for a well known Kepler <span class="math notranslate nohighlight">\(\delta\)</span> Scuti system, KIC 9651065. This tutorial assumes basic working knowledge of PyMC3. <a class="reference external" href="https://docs.exoplanet.codes/en/stable/tutorials/intro-to-pymc3/">A great introduction to this can be found here</a></p>
<p>Now, let’s first download the light curve.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lc</span> <span class="o">=</span> <span class="n">lk</span><span class="o">.</span><span class="n">search_lightcurvefile</span><span class="p">(</span><span class="s1">&#39;KIC 9651065&#39;</span><span class="p">,</span> <span class="n">mission</span><span class="o">=</span><span class="s1">&#39;Kepler&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">download_all</span><span class="p">()</span><span class="o">.</span><span class="n">PDCSAP_FLUX</span><span class="o">.</span><span class="n">stitch</span><span class="p">()</span><span class="o">.</span><span class="n">remove_nans</span><span class="p">()</span>
<span class="n">lc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x114a3f828&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Getting_started_4_1.png" src="../_images/notebooks_Getting_started_4_1.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightkurve automatically subtracts the Kepler zero time (2454844 days), so all times are reported in Barycentric Kepler Julian Date (BKJD). <em>If you want to include additional data, you must work within the same reference time</em>.</p>
</div>
<p>Here, we pass the time and flux data into <code class="docutils literal notranslate"><span class="pre">Maelstrom</span></code>. If the <code class="docutils literal notranslate"><span class="pre">freq</span></code> argument is not specified, <code class="docutils literal notranslate"><span class="pre">Maelstrom</span></code> will automatically try and detect some good peaks to use. Be warned however, this does not always work and you should always check which frequencies you use! I have set the upper limit on the peak search to 40 d<span class="math notranslate nohighlight">\(^{-1}\)</span>, since there are some Nyquist aliases. We can tell they are aliases as their time delays will match the Kepler orbital period. Neat!</p>
<p><code class="docutils literal notranslate"><span class="pre">first_look</span></code> will subdivide the lightcurve using the old method, and make some diagnostic plots. In order, these are the light curve, the amplitude spectrum, the extracted time delays, and the periodogram of the time delays. The frequencies are colored by their amplitude, and the orange line is the weighted average value. We see a nice peak around 272 d in the last panel, which is the orbital period of the system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">maelstrom</span> <span class="kn">import</span> <span class="n">Maelstrom</span>

<span class="n">ms</span> <span class="o">=</span> <span class="n">Maelstrom</span><span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">lc</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">max_peaks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ms</span><span class="o">.</span><span class="n">first_look</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Getting_started_7_0.png" src="../_images/notebooks_Getting_started_7_0.png" />
</div>
</div>
<p>Note that if you want the frequencies <code class="docutils literal notranslate"><span class="pre">Maelstrom</span></code> has found, simply call <code class="docutils literal notranslate"><span class="pre">ms.freq</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Oscillation modes are at </span><span class="si">{ms.freq}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Oscillation modes are at [19.47767606 21.71213419 30.80189468]
</pre></div></div>
</div>
<p>To read off this period, we can calculate the peak in the power spectrum of the time delays (the bottom left panel above)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">period_guess</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">get_period_estimate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The orbital period is around </span><span class="si">{period_guess:.2f}</span><span class="s2"> days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The orbital period is around 269.96 days
</pre></div></div>
</div>
<p>This is pretty good for a few lines of code! In fact, the actual orbital period is closer to 272 d.</p>
<p>Let’s now perform an initial optimisation.. We first need to call <code class="docutils literal notranslate"><span class="pre">setup_orbit_model</span></code>, but an orbital period estimate is not required (unless the time delay signal is very weak..!). We can also pass along an initial guess for the eccentricity, but let’s leave it at 0 and see what happens.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ms</span><span class="o">.</span><span class="n">setup_orbit_model</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="n">period_guess</span><span class="p">)</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">opt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;logperiod&#39;: array(5.60521922),
 &#39;t0&#39;: array(15.39716591),
 &#39;varpi_angle__&#39;: array([ 3.64010862, -2.59799919]),
 &#39;eccen_interval__&#39;: array(-0.19682975),
 &#39;logs&#39;: array(0.21291598),
 &#39;lighttime&#39;: array([178.34565426, 191.30015751, 193.97131511]),
 &#39;mean_flux&#39;: array(0.00075224),
 &#39;W_hat_cos&#39;: array([ 1.7414353 ,  0.46678714, -0.59316665]),
 &#39;W_hat_sin&#39;: array([ 0.2940882 ,  0.62832883, -0.28794189]),
 &#39;period&#39;: array(271.84151162),
 &#39;varpi&#39;: array(2.19066763),
 &#39;eccen&#39;: array(0.4509518),
 &#39;tref&#39;: array(24.82834397)}
</pre></div></div>
</div>
<p>Let’s go through some of those parameters for a sec. The ones not mentioned are nuisance parameters which are required for the model.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t0</span></code>: Time of periastron passage (d)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lighttime</span></code>: The projected semi-major axis calculated for each frequency in the model. Note that most of these agree, indicating that all the frequencies in the <code class="docutils literal notranslate"><span class="pre">Maelstrom</span></code> model belong to the same star.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">period</span></code>: The orbital period of the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">varpi</span></code>: The angle between the ascending node and periapsis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eccen</span></code>: Orbital eccentricity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tref</span></code>: Time of reference passage of periapsis</p></li>
</ul>
<p>Let’s see what the theoretical time delays look like in the optimised model vs the actual extracted values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">td_time</span><span class="p">,</span> <span class="n">td_td</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">get_time_delay</span><span class="p">()</span>
<span class="n">td_average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">td_td</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">get_weights</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">ms</span><span class="p">:</span>
    <span class="n">model_td</span> <span class="o">=</span> <span class="n">xo</span><span class="o">.</span><span class="n">eval_in_model</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">tau</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span> <span class="o">*</span> <span class="mi">86400</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">model_td</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">model_td</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">td_time</span><span class="p">,</span> <span class="n">td_average</span><span class="p">,</span> <span class="s1">&#39;.k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time delay [s]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Time delay [s]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Getting_started_19_1.png" src="../_images/notebooks_Getting_started_19_1.png" />
</div>
</div>
<p>Cool! Each frequency in the light curve has its own independent <code class="docutils literal notranslate"><span class="pre">asini</span></code> in the Maelstrom model. This is useful for when there are multiple stars pulsating in the same binary system, as they would be (mostly) equal and opposite in sign.</p>
<p>However, Maelstrom isn’t actually fitting these parameters. What we’re doing is forward modelling the input light curve by fitting the phase variations (<span class="math notranslate nohighlight">\(\tau\)</span>) in each point;</p>
<p><span class="math notranslate nohighlight">\(y(t) = \sum_{j=1}^{J} \Big[A_j \cos(\omega_j (t - \tau)) + B_j \sin(\omega_j (t-\tau))\Big]\)</span></p>
<p>Although it is not as useful as looking at the time-delays, we can still inspect the actual light curve that is generated from the time delay signal:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">ms</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">xo</span><span class="o">.</span><span class="n">eval_in_model</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">lc_model</span><span class="p">,</span> <span class="n">opt</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Maelstrom&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">205</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux [ppt]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x132291860&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Getting_started_24_1.png" src="../_images/notebooks_Getting_started_24_1.png" />
</div>
</div>
<p>Maelstrom has decided that all these frequencies belong to one star, as their lighttimes are all positive (or negative). This means the system is PB1. We can get a ready-made model from the get go by asking nicely, and passing in the optimisation results. The PB1 model is for binaries with only one pulsating component. All the frequencies now use the same <code class="docutils literal notranslate"><span class="pre">asini</span></code> parameter, unlike our first model</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pb1_model</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">pin_orbit_model</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
<span class="n">pb1_model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$
            \begin{array}{rcl}
            \text{PB1_logs_lc} &amp;\sim &amp; \text{Normal}(\mathit{mu}=0.6424636244773865,~\mathit{sigma}=10.0)\\\text{PB1_mean} &amp;\sim &amp; \text{Normal}(\mathit{mu}=4.582359380833623e-08,~\mathit{sigma}=1.0)\\\text{PB1_lognu} &amp;\sim &amp; \text{Normal}(\mathit{mu}=array,~\mathit{sigma}=0.1)\\\text{PB1_period} &amp;\sim &amp; \text{Deterministic}(\text{Constant},~\text{Constant},~\text{PB1_logP_interval__},~\text{Constant})\\\text{PB1_asini} &amp;\sim &amp; \text{Deterministic}(\text{Constant},~\text{Constant},~\text{PB1_logasini_interval__},~\text{Constant})\\\text{PB1_nu} &amp;\sim &amp; \text{Deterministic}(\text{PB1_lognu})\\\text{PB1_eccen} &amp;\sim &amp; \text{Uniform}(\mathit{lower}=0.0,~\mathit{upper}=0.9)\\\text{PB1_obs} &amp;\sim &amp; \text{Normal}(\mathit{mu}=f(f(f(f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))),~f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))))))))))))),~f(f(f(f(f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))),~f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))))),~f(f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))),~f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))))),~f(f(f(f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))),~f(f(f(f(f(),~\text{PB1_nu})),~f(array,~f(f(f(\text{PB1_asini})),~f(f(f(f(f(f(f(\text{PB1_eccen})))),~f(f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f())))),~f(\text{PB1_omega})))),~f(f(),~f(f(\text{PB1_eccen}),~f(f(f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f(f(\text{PB1_eccen}),~f(f(f(array,~f(\text{PB1_period})),~f(\text{PB1_phi})),~f()))))))))))))))),~array))),~f(\text{PB1_mean})),~\mathit{sigma}=f(f(\text{PB1_logs_lc})))
            \end{array}
            $$</div></div>
</div>
<p>As we can see, pb1_model inherits from the PyMC3 Models object. It is, by definition, a custom model which has access to all of the properties of the default Model class. This means we can do cool things like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pm</span><span class="o">.</span><span class="n">model_to_graphviz</span><span class="p">(</span><span class="n">pb1_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Getting_started_28_0.svg" src="../_images/notebooks_Getting_started_28_0.svg" /></div>
</div>
<p>Finally, if we are happy with the default priors in Maelstrom we can sample the model. There are strong covariances between some of the parameters. This means that sampling will slow down significantly unless we use a custom NUTS step (see <a class="reference external" href="https://exoplanet.dfm.io/en/stable/tutorials/pymc3-extras/#dense-mass-matrices">https://exoplanet.dfm.io/en/stable/tutorials/pymc3-extras/#dense-mass-matrices</a>)</p>
<p>Sampling is quite slow while the mass matrix is tuned (typically the first 1000 steps). Because of this, I’m only going to make 10 draws of the posterior distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">trace</span> <span class="o">=</span> <span class="n">pb1_model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">tune</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">draws</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
optimizing logp for variables: [PB1_mean]
4it [00:00, 22.28it/s, logp=-1.150728e+05]
message: Optimization terminated successfully.
logp: -115072.80884284787 -&gt; -115072.7881902971
optimizing logp for variables: [PB1_logs_lc]
8it [00:00, 27.62it/s, logp=-1.097041e+05]
message: Optimization terminated successfully.
logp: -115072.7881902971 -&gt; -109704.06934437387
optimizing logp for variables: [PB1_omega, PB1_eccen]
45it [00:01, 26.08it/s, logp=-1.066786e+05]
message: Optimization terminated successfully.
logp: -109704.06934437387 -&gt; -106678.6001791905
optimizing logp for variables: [PB1_phi]
20it [00:00, 26.86it/s, logp=-1.066570e+05]
message: Optimization terminated successfully.
logp: -106678.6001791905 -&gt; -106657.04265097293
optimizing logp for variables: [PB1_lognu]
103it [00:03, 32.85it/s, logp=-1.066545e+05]
message: Desired error not necessarily achieved due to precision loss.
logp: -106657.04265097293 -&gt; -106654.54220594438
optimizing logp for variables: [PB1_eccen, PB1_omega, PB1_lognu, PB1_mean, PB1_logasini, PB1_logs_lc, PB1_phi, PB1_logP]
323it [00:11, 27.99it/s, logp=-1.064707e+05]
message: Desired error not necessarily achieved due to precision loss.
logp: -106654.54220594438 -&gt; -106470.71703961623
optimizing logp for variables: [PB1_logasini]
67it [00:02, 32.72it/s, logp=-1.064707e+05]
message: Desired error not necessarily achieved due to precision loss.
logp: -106470.71703961623 -&gt; -106470.71703961623
optimizing logp for variables: [PB1_eccen, PB1_omega, PB1_lognu, PB1_mean, PB1_logasini, PB1_logs_lc, PB1_phi, PB1_logP]
81it [00:02, 27.78it/s, logp=-1.508331e+05]
message: Desired error not necessarily achieved due to precision loss.
logp: -106470.71703961623 -&gt; -106470.71703961623
optimizing logp for variables: [PB1_logP]
4it [00:00, 23.40it/s, logp=-1.064707e+05]
message: Optimization terminated successfully.
logp: -106470.71703961623 -&gt; -106470.71703961515
optimizing logp for variables: [PB1_eccen, PB1_omega, PB1_lognu, PB1_mean, PB1_logasini, PB1_logs_lc, PB1_phi, PB1_logP]
133it [00:04, 28.31it/s, logp=-1.064707e+05]
message: Desired error not necessarily achieved due to precision loss.
logp: -106470.71703961515 -&gt; -106470.71703961305
Only 10 samples in chain.
Multiprocess sampling (2 chains in 2 jobs)
NUTS: [PB1_eccen, PB1_omega, PB1_lognu, PB1_mean, PB1_logasini, PB1_logs_lc, PB1_phi, PB1_logP]
Sampling 2 chains: 100%|██████████| 40/40 [00:59&lt;00:00,  1.49s/draws]
/Users/danielhey/anaconda3/lib/python3.7/site-packages/pymc3/sampling.py:464: UserWarning: The number of samples is too small to check convergence reliably.
  warnings.warn(&#34;The number of samples is too small to check convergence reliably.&#34;)
There were 7 divergences after tuning. Increase `target_accept` or reparameterize.
The acceptance probability does not match the target. It is 0.06641073900830238, but should be close to 0.9. Try to increase the number of tuning steps.
There were 7 divergences after tuning. Increase `target_accept` or reparameterize.
The acceptance probability does not match the target. It is 2.2473988127317096e-06, but should be close to 0.9. Try to increase the number of tuning steps.
</pre></div></div>
</div>
<p>Look at all those errors! That’s because we only sampled for 10 steps across 2 chains. For a full sampling run, check out the case studies in the sidebar.</p>
<p>In any case, our trace is a PyMC3 trace object which can be manipulated accordingly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pm</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/danielhey/anaconda3/lib/python3.7/site-packages/pymc3/stats.py:991: FutureWarning: The join_axes-keyword is deprecated. Use .reindex or .reindex_like on the result to achieve the same functionality.
  axis=1, join_axes=[dforg.index])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>mc_error</th>
      <th>hpd_2.5</th>
      <th>hpd_97.5</th>
      <th>n_eff</th>
      <th>Rhat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PB1_logs_lc</th>
      <td>0.212922</td>
      <td>8.600234e-06</td>
      <td>2.719611e-06</td>
      <td>0.212913</td>
      <td>0.212931</td>
      <td>NaN</td>
      <td>234.349313</td>
    </tr>
    <tr>
      <th>PB1_mean</th>
      <td>0.000748</td>
      <td>9.571820e-06</td>
      <td>3.026826e-06</td>
      <td>0.000739</td>
      <td>0.000758</td>
      <td>NaN</td>
      <td>103.871715</td>
    </tr>
    <tr>
      <th>PB1_lognu__0</th>
      <td>2.969269</td>
      <td>3.418779e-08</td>
      <td>1.057404e-08</td>
      <td>2.969269</td>
      <td>2.969269</td>
      <td>NaN</td>
      <td>4.133664</td>
    </tr>
    <tr>
      <th>PB1_lognu__1</th>
      <td>3.077871</td>
      <td>1.183244e-07</td>
      <td>3.247042e-08</td>
      <td>3.077871</td>
      <td>3.077872</td>
      <td>NaN</td>
      <td>1.318653</td>
    </tr>
    <tr>
      <th>PB1_lognu__2</th>
      <td>3.427576</td>
      <td>6.475697e-08</td>
      <td>1.901471e-08</td>
      <td>3.427576</td>
      <td>3.427576</td>
      <td>NaN</td>
      <td>1.087233</td>
    </tr>
    <tr>
      <th>PB1_logP</th>
      <td>5.605784</td>
      <td>7.644901e-06</td>
      <td>2.417445e-06</td>
      <td>5.605777</td>
      <td>5.605792</td>
      <td>NaN</td>
      <td>69.104374</td>
    </tr>
    <tr>
      <th>PB1_period</th>
      <td>271.995197</td>
      <td>2.079376e-03</td>
      <td>6.575335e-04</td>
      <td>271.993118</td>
      <td>271.997319</td>
      <td>1.052922</td>
      <td>69.103851</td>
    </tr>
    <tr>
      <th>PB1_phi</th>
      <td>0.569194</td>
      <td>2.178819e-06</td>
      <td>6.889910e-07</td>
      <td>0.569192</td>
      <td>0.569196</td>
      <td>NaN</td>
      <td>120.295888</td>
    </tr>
    <tr>
      <th>PB1_logasini</th>
      <td>5.221367</td>
      <td>1.418273e-05</td>
      <td>4.484865e-06</td>
      <td>5.221352</td>
      <td>5.221381</td>
      <td>NaN</td>
      <td>72.400180</td>
    </tr>
    <tr>
      <th>PB1_asini</th>
      <td>185.187119</td>
      <td>2.626459e-03</td>
      <td>8.305392e-04</td>
      <td>185.184426</td>
      <td>185.189745</td>
      <td>1.052904</td>
      <td>72.401205</td>
    </tr>
    <tr>
      <th>PB1_nu__0</th>
      <td>19.477680</td>
      <td>6.658988e-07</td>
      <td>2.059578e-07</td>
      <td>19.477679</td>
      <td>19.477681</td>
      <td>NaN</td>
      <td>4.133665</td>
    </tr>
    <tr>
      <th>PB1_nu__1</th>
      <td>21.712135</td>
      <td>2.569075e-06</td>
      <td>7.050022e-07</td>
      <td>21.712132</td>
      <td>21.712139</td>
      <td>3.268674</td>
      <td>1.318653</td>
    </tr>
    <tr>
      <th>PB1_nu__2</th>
      <td>30.801896</td>
      <td>1.994638e-06</td>
      <td>5.856890e-07</td>
      <td>30.801893</td>
      <td>30.801898</td>
      <td>4.569588</td>
      <td>1.087233</td>
    </tr>
    <tr>
      <th>PB1_omega</th>
      <td>2.201137</td>
      <td>5.935100e-07</td>
      <td>1.876577e-07</td>
      <td>2.201136</td>
      <td>2.201138</td>
      <td>NaN</td>
      <td>30.042722</td>
    </tr>
    <tr>
      <th>PB1_eccen</th>
      <td>0.457221</td>
      <td>7.910098e-07</td>
      <td>2.500954e-07</td>
      <td>0.457220</td>
      <td>0.457222</td>
      <td>1.054756</td>
      <td>25.987299</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Estimating frequencies.html" class="btn btn-neutral float-right" title="Choosing the correct frequencies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../user/citation.html" class="btn btn-neutral float-left" title="Citing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Daniel Hey

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-144184844-2', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>